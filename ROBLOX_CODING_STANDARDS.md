# Roblox コーディング規約

Roblox開発におけるコーディング規約を定義。

> 開発ワークフロー・ブランチ戦略・Issue/PR規約は [DEV_WORKFLOW.md](./DEV_WORKFLOW.md) を参照。

---

## コア技術

- **言語**: Luau (--!strict モード)
- **プラットフォーム**: Roblox Engine
- **ビルドツール**: Rojo

---

## 型安全

- **Strictモード**: すべてのLuauファイルで`--!strict`を使用
- **型エクスポート**: `Types.lua`で全ての型定義を一元管理し、`export type`でエクスポート
- **型アノテーション**: 関数パラメータと戻り値に明示的な型を指定

---

## コード品質

- **エラーハンドリング**: `ErrorHandler`モジュールを使用して一貫したエラーログ出力
- **バリデーション**: `Validation`モジュールでクライアント入力を検証（エクスプロイト対策）
- **命名規則**: PascalCaseモジュール名、camelCase関数名

---

## テスト戦略

**Robloxにおける自動テストの制約**:
- `Instance.new("Player")`が使用不可のため、Playerインスタンスを必要とする統合テストは自動化できない
- サーバースクリプトでのテスト実行にはRoblox Studio環境と実際のプレイヤー参加が必要

**テスト戦略**:

1. **手動統合テスト**: 実際のプレイヤー参加を前提とした手動テスト手順書
   - 各specの`manual-testing.md`に詳細な手順、期待される動作、ログ出力、成功基準を記載

2. **コード検査**: ロジックの正確性をコードレビューとLuau --strict型チェックで検証

3. **ログ出力検証**: ErrorHandlerモジュールによる一貫したログ出力で実行時の動作を追跡・確認

---

## 開発環境

**必要ツール**:
- Roblox Studio
- Rojo 7.x+
- Git

**Rojoインストール**:
```bash
# Aftmanでインストール（推奨）
aftman add rojo-rbx/rojo

# またはForeman
foreman install
```

**ビルドファイル命名規則**:

| ファイル名 | 用途 | 説明 |
|-----------|------|------|
| `{リポジトリ名}.rbxl` | **本番用** | パブリッシュ用のビルドファイル |
| `{リポジトリ名}-dev.rbxl` | **開発用** | ローカルテスト・デバッグ用 |

**ルール**:
- 本番用ファイルのみGitで管理（`.gitignore`で開発用を除外）
- パブリッシュ前は必ず本番用ファイルでビルド
- 開発用ファイルは各開発者のローカル環境で使用

**よく使うコマンド**:
```bash
# 本番用ビルド
rojo build -o {リポジトリ名}.rbxl

# 開発用ビルド
rojo build -o {リポジトリ名}-dev.rbxl

# 同期: ライブ同期でRoblox Studioと連携
rojo serve
```

---

_Roblox コーディング規約に関するドキュメント_
